
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Spin</title>
  <style>
    body { background: #0a0f2c; color: #fff; font-family: sans-serif; text-align: center; padding-top: 100px; }
    button { padding: 15px 30px; font-size: 18px; background: linear-gradient(45deg, #007bff, #00c2ff); border: none; border-radius: 10px; color: white; cursor: pointer; }
    #reward-screen { display: none; margin-top: 40px; }
    #nft-image { width: 200px; height: 200px; object-fit: contain; border: 2px solid #fff; border-radius: 12px; }
  </style>
</head>
<body>
  <button id="spin-button">Испытать фортуну</button>

  <div id="reward-screen">
    <img id="nft-image" src="" alt="NFT Image" />
    <h2 id="nft-name">Ваш подарок появится здесь</h2>
    <button onclick="alert('NFT отправлен!')">Забрать подарок</button>
  </div>

  
<script>
async function getDropResult(spinCount) {
  const dropLogic = await fetch('drop_logic.json').then(res => res.json());
  const nftBank = await fetch('nft_bank.json').then(res => res.json());

  let stepConfig = dropLogic.steps.find(step => {
    const [min, max] = step.range;
    return spinCount >= min && (max === "infinity" || spinCount <= max);
  });

  let rarity;

  if (stepConfig.guaranteed_rarity) {
    rarity = stepConfig.guaranteed_rarity;
  } else if (stepConfig.allowed_rarities) {
    rarity = stepConfig.allowed_rarities[0];
  } else if (stepConfig.chance_table) {
    const roll = Math.random();
    let sum = 0;
    for (const item of stepConfig.chance_table) {
      sum += item.chance;
      if (roll < sum) {
        rarity = item.rarity;
        break;
      }
    }
  }

  const possibleNFTs = nftBank[rarity];
  const chosenNFT = possibleNFTs[Math.floor(Math.random() * possibleNFTs.length)];

  // Отображаем результат
  document.getElementById("nft-name").textContent = `${rarity.toUpperCase()} – ${chosenNFT.name}`;
  document.getElementById("nft-image").src = chosenNFT.image;
  document.getElementById("reward-screen").style.display = "block";
}

document.getElementById("spin-button").addEventListener("click", () => {
  const spinCount = parseInt(localStorage.getItem("spins") || "0") + 1;
  localStorage.setItem("spins", spinCount);
  getDropResult(spinCount);
});
</script>

</body>
</html>
Update spin logic
